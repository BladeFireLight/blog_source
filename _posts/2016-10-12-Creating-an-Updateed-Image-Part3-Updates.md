---
title: Windows Image Tools \| Creating an Updated Image Part 3
modified:
categories: [WindowsImageTools]
excerpt: One of the time consuming steps to deploying new VMs is the time spend managing Images and and applying patches. I’m not big on Golden images. I tend to use a fully patched VHDX or VMDK  and let DSC handle the configuration and software. This is not the fastest, and at scale you need to create more then one image based on what saves the most time.  (IIS, SQL, Exchange, etc…).
tags: [VHDX, WindowsUpdate, WindowsUpdateTools, Module]
date: 2016-10-12T16:48:59-05:00
---

{% include toc %}

## Plan for today

The end game is in site. Now that I have 2 images with WMF 5. it's time to apply all the Windows Updates. 

## Prerequisites

If you are folowing along you shoudl have a WindowsImageTools Update directory with two images. A striped down Core image, and all you can eat GUI image for source.

## Kicking off Updates

First off I'm going to run the updates. There are a nubmer of ways to do this, Invoke-WindowsUpdate can target individual images or all the images in our Update folders, and it can control the output.
Because i'm doing source and small core images. I will update each image separately, and export the WIM only for the source, and shrink the Core

Lets start with the source

<figure class="highlight"><pre><code><span style="color:#E0FFFF;">get-date</span><br class=""/><span style="color:#E0FFFF;">Invoke-WindowsImageUpdate</span>&nbsp;<span style="color:#FFE4B5;">-Path</span>&nbsp;<span style="color:#EE82EE;">G:\Blog_Example</span>&nbsp;<span style="color:#FFE4B5;">-output</span>&nbsp;<span style="color:#EE82EE;">Both</span>&nbsp;<span style="color:#FFE4B5;">-ImageName</span>&nbsp;<span style="color:#EE82EE;">Srv2012r2_Core</span>&nbsp;<span style="color:#FFE4B5;">-ReduceImageSize</span>&nbsp;<span style="color:#FFE4B5;">-Verbose</span><br class=""/><span style="color:#E0FFFF;">get-date</span><br class=""/><span style="color:#E0FFFF;">Invoke-WindowsImageUpdate</span>&nbsp;<span style="color:#FFE4B5;">-Path</span>&nbsp;<span style="color:#EE82EE;">G:\Blog_Example</span>&nbsp;<span style="color:#FFE4B5;">-output</span>&nbsp;<span style="color:#EE82EE;">WIM</span>&nbsp;<span style="color:#FFE4B5;">-ImageName</span>&nbsp;<span style="color:#EE82EE;">Srv2012r2_Source</span>&nbsp;<span style="color:#FFE4B5;">-Verbose</span><br class=""/><span style="color:#E0FFFF;">get-date</span><br class=""/></code></pre>
</figure>

<figure class="highlight"><pre><code><span style="color:#F5F5F5;">Wednesday,&nbsp;October&nbsp;12,&nbsp;2016&nbsp;12:26:17&nbsp;AM</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;Validateing&nbsp;[Srv2012r2_Core]</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;Validateing&nbsp;VM&nbsp;switch&nbsp;config</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Performing&nbsp;the&nbsp;operation&nbsp;&quot;Download&nbsp;required&nbsp;Modules&quot;&nbsp;on&nbsp;target&nbsp;&quot;PowerShell&nbsp;Gallery&quot;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Loading&nbsp;module&nbsp;from&nbsp;path&nbsp;&#39;C:\Program&nbsp;Files\WindowsPowerShell\Modules\PackageManagement\1.0.0.1\PackageManagement.psd1&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Loading&nbsp;&#39;FormatsToProcess&#39;&nbsp;from&nbsp;path&nbsp;&#39;C:\Program&nbsp;Files\WindowsPowerShell\Modules\PackageManagement\1.0.0.1\PackageManagement.format.ps1xml&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Loading&nbsp;module&nbsp;from&nbsp;path&nbsp;&#39;C:\Program&nbsp;Files\WindowsPowerShell\Modules\PackageManagement\1.0.0.1\Microsoft.PowerShell.PackageManagement.dll&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Exporting&nbsp;cmdlet&nbsp;&#39;Find-Package&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Exporting&nbsp;cmdlet&nbsp;&#39;Get-Package&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Exporting&nbsp;cmdlet&nbsp;&#39;Get-PackageProvider&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Exporting&nbsp;cmdlet&nbsp;&#39;Get-PackageSource&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Exporting&nbsp;cmdlet&nbsp;&#39;Install-Package&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Exporting&nbsp;cmdlet&nbsp;&#39;Import-PackageProvider&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Exporting&nbsp;cmdlet&nbsp;&#39;Find-PackageProvider&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Exporting&nbsp;cmdlet&nbsp;&#39;Install-PackageProvider&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Exporting&nbsp;cmdlet&nbsp;&#39;Register-PackageSource&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Exporting&nbsp;cmdlet&nbsp;&#39;Save-Package&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Exporting&nbsp;cmdlet&nbsp;&#39;Set-PackageSource&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Exporting&nbsp;cmdlet&nbsp;&#39;Uninstall-Package&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Exporting&nbsp;cmdlet&nbsp;&#39;Unregister-PackageSource&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Importing&nbsp;cmdlet&nbsp;&#39;Find-Package&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Importing&nbsp;cmdlet&nbsp;&#39;Find-PackageProvider&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Importing&nbsp;cmdlet&nbsp;&#39;Get-Package&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Importing&nbsp;cmdlet&nbsp;&#39;Get-PackageProvider&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Importing&nbsp;cmdlet&nbsp;&#39;Get-PackageSource&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Importing&nbsp;cmdlet&nbsp;&#39;Import-PackageProvider&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Importing&nbsp;cmdlet&nbsp;&#39;Install-Package&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Importing&nbsp;cmdlet&nbsp;&#39;Install-PackageProvider&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Importing&nbsp;cmdlet&nbsp;&#39;Register-PackageSource&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Importing&nbsp;cmdlet&nbsp;&#39;Save-Package&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Importing&nbsp;cmdlet&nbsp;&#39;Set-PackageSource&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Importing&nbsp;cmdlet&nbsp;&#39;Uninstall-Package&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Importing&nbsp;cmdlet&nbsp;&#39;Unregister-PackageSource&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;Geting&nbsp;latest&nbsp;PSWindowsUpdate</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Using&nbsp;the&nbsp;provider&nbsp;&#39;PowerShellGet&#39;&nbsp;for&nbsp;searching&nbsp;packages.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;The&nbsp;-Repository&nbsp;parameter&nbsp;was&nbsp;not&nbsp;specified.&nbsp;&nbsp;PowerShellGet&nbsp;will&nbsp;use&nbsp;all&nbsp;of&nbsp;the&nbsp;registered&nbsp;repositories.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Getting&nbsp;the&nbsp;provider&nbsp;object&nbsp;for&nbsp;the&nbsp;PackageManagement&nbsp;Provider&nbsp;&#39;NuGet&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;The&nbsp;specified&nbsp;Location&nbsp;is&nbsp;&#39;https://www.powershellgallery.com/api/v2/&#39;&nbsp;and&nbsp;PackageManagementProvider&nbsp;is&nbsp;&#39;NuGet&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Searching&nbsp;repository&nbsp;&#39;https://www.powershellgallery.com/api/v2/FindPackagesById()?id=&#39;PSWindowsUpdate&#39;&#39;&nbsp;for&nbsp;&#39;&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Total&nbsp;package&nbsp;yield:&#39;1&#39;&nbsp;for&nbsp;the&nbsp;specified&nbsp;package&nbsp;&#39;PSWindowsUpdate&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Performing&nbsp;the&nbsp;operation&nbsp;&quot;Save&nbsp;Package&quot;&nbsp;on&nbsp;target&nbsp;&quot;&#39;PSWindowsUpdate&#39;&nbsp;to&nbsp;location&nbsp;&#39;G:\Blog_Example\Resource\Modules&#39;&quot;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;The&nbsp;specified&nbsp;module&nbsp;will&nbsp;be&nbsp;installed&nbsp;in&nbsp;&#39;G:\Blog_Example\Resource\Modules&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;The&nbsp;specified&nbsp;Location&nbsp;is&nbsp;&#39;NuGet&#39;&nbsp;and&nbsp;PackageManagementProvider&nbsp;is&nbsp;&#39;NuGet&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Downloading&nbsp;module&nbsp;&#39;PSWindowsUpdate&#39;&nbsp;with&nbsp;version&nbsp;&#39;1.5.2.2&#39;&nbsp;from&nbsp;the&nbsp;repository&nbsp;&#39;https://www.powershellgallery.com/api/v2/&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Searching&nbsp;repository&nbsp;&#39;https://www.powershellgallery.com/api/v2/FindPackagesById()?id=&#39;PSWindowsUpdate&#39;&#39;&nbsp;for&nbsp;&#39;&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;InstallPackage&#39;&nbsp;-&nbsp;name=&#39;PSWindowsUpdate&#39;,&nbsp;version=&#39;1.5.2.2&#39;,destination=&#39;C:\Users\Blade_000\AppData\Local\Temp\239759536&#39;</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;DownloadPackage&#39;&nbsp;-&nbsp;name=&#39;PSWindowsUpdate&#39;,&nbsp;version=&#39;1.5.2.2&#39;,destination=&#39;C:\Users\Blade_000\AppData\Local\Temp\239759536\PSWindowsUpdate\PSWindowsUpdate.nupkg&#39;,&nbsp;uri=&#39;https://www.powershellgallery.com/api/v2/package/PSWindowsUpdate/1.5.2.2&#39;</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Downloading&nbsp;&#39;https://www.powershellgallery.com/api/v2/package/PSWindowsUpdate/1.5.2.2&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Completed&nbsp;downloading&nbsp;&#39;https://www.powershellgallery.com/api/v2/package/PSWindowsUpdate/1.5.2.2&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Completed&nbsp;downloading&nbsp;&#39;PSWindowsUpdate&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Hash&nbsp;for&nbsp;package&nbsp;&#39;PSWindowsUpdate&#39;&nbsp;does&nbsp;not&nbsp;match&nbsp;hash&nbsp;provided&nbsp;from&nbsp;the&nbsp;server.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;InstallPackageLocal&#39;&nbsp;-&nbsp;name=&#39;PSWindowsUpdate&#39;,&nbsp;version=&#39;1.5.2.2&#39;,destination=&#39;C:\Users\Blade_000\AppData\Local\Temp\239759536&#39;</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Module&nbsp;&#39;PSWindowsUpdate&#39;&nbsp;was&nbsp;saved&nbsp;successfully&nbsp;to&nbsp;path&nbsp;&#39;G:\Blog_Example\Resource\Modules\PSWindowsUpdate\1.5.2.2&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Performing&nbsp;the&nbsp;operation&nbsp;&quot;Invoke&nbsp;Windows&nbsp;Updates&nbsp;on&nbsp;Image&quot;&nbsp;on&nbsp;target&nbsp;&quot;Srv2012r2_Core&quot;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;Windows&nbsp;Update&nbsp;:&nbsp;New&nbsp;Diff&nbsp;Disk&nbsp;:&nbsp;Creating&nbsp;G:\Blog_Example\BaseImage\Srv2012r2_Core_Update.vhdx&nbsp;from&nbsp;G:\Blog_Example\BaseImage\Srv2012r2_Core_base.vhdx</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;New-VHD&nbsp;will&nbsp;create&nbsp;a&nbsp;new&nbsp;virtual&nbsp;hard&nbsp;disk&nbsp;with&nbsp;the&nbsp;path&nbsp;&quot;G:\Blog_Example\BaseImage\Srv2012r2_Core_Update.vhdx&quot;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;Windows&nbsp;Update&nbsp;:&nbsp;Adding&nbsp;PSWindowsUpdate&nbsp;Module&nbsp;to&nbsp;G:\Blog_Example\BaseImage\Srv2012r2_Core_Update.vhdx</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;Windows&nbsp;Update&nbsp;:&nbsp;updateting&nbsp;AtStartup&nbsp;script</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Sidebyside&nbsp;detected&nbsp;in&nbsp;PSWindowsUpdate&nbsp;:&nbsp;switching&nbsp;to&nbsp;v4&nbsp;compatability</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[createRunAndWaitVM]&nbsp;:&nbsp;Creating&nbsp;VM&nbsp;40floaow&nbsp;at&nbsp;10/12/2016&nbsp;00:26:34</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[createRunAndWaitVM]&nbsp;:&nbsp;VM&nbsp;40floaow&nbsp;Stoped</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[createRunAndWaitVM]&nbsp;:&nbsp;VM&nbsp;40floaow&nbsp;Deleted&nbsp;at&nbsp;10/12/2016&nbsp;02:25:36</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;Windows&nbsp;Update&nbsp;:&nbsp;Changes&nbsp;detected&nbsp;:&nbsp;Merging&nbsp;G:\Blog_Example\BaseImage\Srv2012r2_Core_Update.vhdx&nbsp;into&nbsp;G:\Blog_Example\BaseImage\Srv2012r2_Core_base.vhdx</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Merge-VHD&nbsp;will&nbsp;merge&nbsp;the&nbsp;virtual&nbsp;hard&nbsp;disk&nbsp;&quot;g:\blog_example\baseimage\srv2012r2_core_update.vhdx&quot;&nbsp;into&nbsp;its&nbsp;parent&nbsp;&quot;g:\blog_example\baseimage\srv2012r2_core_base.vhdx&quot;.</span><br class=""/><span style="color:#F5F5F5;">Wednesday,&nbsp;October&nbsp;12,&nbsp;2016&nbsp;2:28:08&nbsp;AM</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;Validateing&nbsp;[Srv2012r2_Source]</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;Validateing&nbsp;VM&nbsp;switch&nbsp;config</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Performing&nbsp;the&nbsp;operation&nbsp;&quot;Download&nbsp;required&nbsp;Modules&quot;&nbsp;on&nbsp;target&nbsp;&quot;PowerShell&nbsp;Gallery&quot;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;Geting&nbsp;latest&nbsp;PSWindowsUpdate</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Using&nbsp;the&nbsp;provider&nbsp;&#39;PowerShellGet&#39;&nbsp;for&nbsp;searching&nbsp;packages.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;The&nbsp;-Repository&nbsp;parameter&nbsp;was&nbsp;not&nbsp;specified.&nbsp;&nbsp;PowerShellGet&nbsp;will&nbsp;use&nbsp;all&nbsp;of&nbsp;the&nbsp;registered&nbsp;repositories.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Getting&nbsp;the&nbsp;provider&nbsp;object&nbsp;for&nbsp;the&nbsp;PackageManagement&nbsp;Provider&nbsp;&#39;NuGet&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;The&nbsp;specified&nbsp;Location&nbsp;is&nbsp;&#39;https://www.powershellgallery.com/api/v2/&#39;&nbsp;and&nbsp;PackageManagementProvider&nbsp;is&nbsp;&#39;NuGet&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Searching&nbsp;repository&nbsp;&#39;https://www.powershellgallery.com/api/v2/FindPackagesById()?id=&#39;PSWindowsUpdate&#39;&#39;&nbsp;for&nbsp;&#39;&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Total&nbsp;package&nbsp;yield:&#39;1&#39;&nbsp;for&nbsp;the&nbsp;specified&nbsp;package&nbsp;&#39;PSWindowsUpdate&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Performing&nbsp;the&nbsp;operation&nbsp;&quot;Save&nbsp;Package&quot;&nbsp;on&nbsp;target&nbsp;&quot;&#39;PSWindowsUpdate&#39;&nbsp;to&nbsp;location&nbsp;&#39;G:\Blog_Example\Resource\Modules&#39;&quot;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;The&nbsp;specified&nbsp;module&nbsp;will&nbsp;be&nbsp;installed&nbsp;in&nbsp;&#39;G:\Blog_Example\Resource\Modules&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;The&nbsp;specified&nbsp;Location&nbsp;is&nbsp;&#39;NuGet&#39;&nbsp;and&nbsp;PackageManagementProvider&nbsp;is&nbsp;&#39;NuGet&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Downloading&nbsp;module&nbsp;&#39;PSWindowsUpdate&#39;&nbsp;with&nbsp;version&nbsp;&#39;1.5.2.2&#39;&nbsp;from&nbsp;the&nbsp;repository&nbsp;&#39;https://www.powershellgallery.com/api/v2/&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Searching&nbsp;repository&nbsp;&#39;https://www.powershellgallery.com/api/v2/FindPackagesById()?id=&#39;PSWindowsUpdate&#39;&#39;&nbsp;for&nbsp;&#39;&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;InstallPackage&#39;&nbsp;-&nbsp;name=&#39;PSWindowsUpdate&#39;,&nbsp;version=&#39;1.5.2.2&#39;,destination=&#39;C:\Users\Blade_000\AppData\Local\Temp\1874556358&#39;</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;DownloadPackage&#39;&nbsp;-&nbsp;name=&#39;PSWindowsUpdate&#39;,&nbsp;version=&#39;1.5.2.2&#39;,destination=&#39;C:\Users\Blade_000\AppData\Local\Temp\1874556358\PSWindowsUpdate\PSWindowsUpdate.nupkg&#39;,&nbsp;uri=&#39;https://www.powershellgallery.com/api/v2/package/PSWindowsUpdate/1.5.2.2&#39;</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Downloading&nbsp;&#39;https://www.powershellgallery.com/api/v2/package/PSWindowsUpdate/1.5.2.2&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Completed&nbsp;downloading&nbsp;&#39;https://www.powershellgallery.com/api/v2/package/PSWindowsUpdate/1.5.2.2&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Completed&nbsp;downloading&nbsp;&#39;PSWindowsUpdate&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Hash&nbsp;for&nbsp;package&nbsp;&#39;PSWindowsUpdate&#39;&nbsp;does&nbsp;not&nbsp;match&nbsp;hash&nbsp;provided&nbsp;from&nbsp;the&nbsp;server.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;InstallPackageLocal&#39;&nbsp;-&nbsp;name=&#39;PSWindowsUpdate&#39;,&nbsp;version=&#39;1.5.2.2&#39;,destination=&#39;C:\Users\Blade_000\AppData\Local\Temp\1874556358&#39;</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Module&nbsp;&#39;PSWindowsUpdate&#39;&nbsp;was&nbsp;saved&nbsp;successfully&nbsp;to&nbsp;path&nbsp;&#39;G:\Blog_Example\Resource\Modules\PSWindowsUpdate\1.5.2.2&#39;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Performing&nbsp;the&nbsp;operation&nbsp;&quot;Invoke&nbsp;Windows&nbsp;Updates&nbsp;on&nbsp;Image&quot;&nbsp;on&nbsp;target&nbsp;&quot;Srv2012r2_Source&quot;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;Windows&nbsp;Update&nbsp;:&nbsp;New&nbsp;Diff&nbsp;Disk&nbsp;:&nbsp;Creating&nbsp;G:\Blog_Example\BaseImage\Srv2012r2_Source_Update.vhdx&nbsp;from&nbsp;G:\Blog_Example\BaseImage\Srv2012r2_Source_base.vhdx</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;New-VHD&nbsp;will&nbsp;create&nbsp;a&nbsp;new&nbsp;virtual&nbsp;hard&nbsp;disk&nbsp;with&nbsp;the&nbsp;path&nbsp;&quot;G:\Blog_Example\BaseImage\Srv2012r2_Source_Update.vhdx&quot;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;Windows&nbsp;Update&nbsp;:&nbsp;Adding&nbsp;PSWindowsUpdate&nbsp;Module&nbsp;to&nbsp;G:\Blog_Example\BaseImage\Srv2012r2_Source_Update.vhdx</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;Windows&nbsp;Update&nbsp;:&nbsp;updateting&nbsp;AtStartup&nbsp;script</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Sidebyside&nbsp;detected&nbsp;in&nbsp;PSWindowsUpdate&nbsp;:&nbsp;switching&nbsp;to&nbsp;v4&nbsp;compatability</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[createRunAndWaitVM]&nbsp;:&nbsp;Creating&nbsp;VM&nbsp;5dvm2bu2&nbsp;at&nbsp;10/12/2016&nbsp;02:28:24</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[createRunAndWaitVM]&nbsp;:&nbsp;VM&nbsp;5dvm2bu2&nbsp;Stoped</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[createRunAndWaitVM]&nbsp;:&nbsp;VM&nbsp;5dvm2bu2&nbsp;Deleted&nbsp;at&nbsp;10/12/2016&nbsp;05:30:56</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;Windows&nbsp;Update&nbsp;:&nbsp;Changes&nbsp;detected&nbsp;:&nbsp;Merging&nbsp;G:\Blog_Example\BaseImage\Srv2012r2_Source_Update.vhdx&nbsp;into&nbsp;G:\Blog_Example\BaseImage\Srv2012r2_Source_base.vhdx</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;Merge-VHD&nbsp;will&nbsp;merge&nbsp;the&nbsp;virtual&nbsp;hard&nbsp;disk&nbsp;&quot;g:\blog_example\baseimage\srv2012r2_source_update.vhdx&quot;&nbsp;into&nbsp;its&nbsp;parent&nbsp;&quot;g:\blog_example\baseimage\srv2012r2_source_base.vhdx&quot;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;SysPrep&nbsp;:&nbsp;New&nbsp;Diff&nbsp;Disk&nbsp;:&nbsp;Creating&nbsp;G:\Blog_Example\BaseImage\Srv2012r2_Source_Sysprep.vhdx&nbsp;from&nbsp;G:\Blog_Example\BaseImage\Srv2012r2_Source_base.vhdx</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;New-VHD&nbsp;will&nbsp;create&nbsp;a&nbsp;new&nbsp;virtual&nbsp;hard&nbsp;disk&nbsp;with&nbsp;the&nbsp;path&nbsp;&quot;G:\Blog_Example\BaseImage\Srv2012r2_Source_Sysprep.vhdx&quot;.</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;SysPrep&nbsp;:&nbsp;updateting&nbsp;AtStartup&nbsp;script</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;SysPrep&nbsp;:&nbsp;Creating&nbsp;temp&nbsp;vm&nbsp;and&nbsp;waiting</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[createRunAndWaitVM]&nbsp;:&nbsp;Creating&nbsp;VM&nbsp;4nxvrw5x&nbsp;at&nbsp;10/12/2016&nbsp;05:34:45</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[createRunAndWaitVM]&nbsp;:&nbsp;VM&nbsp;4nxvrw5x&nbsp;Stoped</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[createRunAndWaitVM]&nbsp;:&nbsp;VM&nbsp;4nxvrw5x&nbsp;Deleted&nbsp;at&nbsp;10/12/2016&nbsp;05:41:37</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;SysPrep&nbsp;:&nbsp;Removing&nbsp;PageFile&nbsp;and&nbsp;PsTemp</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;SysPrep&nbsp;:&nbsp;Cleaning&nbsp;SxS</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;WIM&nbsp;:&nbsp;Creating&nbsp;G:\Blog_Example\UpdatedImageShare\Srv2012r2_Source.wim</span><br class=""/><span style="color:#00FFFF;">VERBOSE:&nbsp;[Invoke-WindowsImageUpdate]&nbsp;:&nbsp;WIM&nbsp;:&nbsp;removing&nbsp;G:\Blog_Example\BaseImage\Srv2012r2_Source_Sysprep.vhdx</span><br class=""/><span style="color:#F5F5F5;">Wednesday,&nbsp;October&nbsp;12,&nbsp;2016&nbsp;6:19:52&nbsp;AM</span><br class=""/><br class=""/></code></pre>
</figure>


After a few hours I have a a fully patched system.

```
G:\Blog_Example\UpdatedImageShare

    Directory: G:\Blog_Example\UpdatedImageShare

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        9/27/2016   3:24 PM     7541358592 Srv2012r2_Core.vhdx 
-a----        9/27/2016   3:14 PM     3415926982 Srv2012r2_Core.wim
-a----        9/26/2016   6:36 PM     4523302203 Srv2012r2_Source.wim  
```
